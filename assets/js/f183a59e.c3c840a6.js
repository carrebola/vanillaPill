"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1339],{3905:(e,a,t)=>{t.d(a,{Zo:()=>c,kt:()=>g});var n=t(7294);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function o(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function s(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?o(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function i(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var u=n.createContext({}),l=function(e){var a=n.useContext(u),t=a;return e&&(t="function"==typeof e?e(a):s(s({},a),e)),t},c=function(e){var a=l(e.components);return n.createElement(u.Provider,{value:a},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},m=n.forwardRef((function(e,a){var t=e.components,r=e.mdxType,o=e.originalType,u=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=l(t),m=r,g=p["".concat(u,".").concat(m)]||p[m]||d[m]||o;return t?n.createElement(g,s(s({ref:a},c),{},{components:t})):n.createElement(g,s({ref:a},c))}));function g(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var o=t.length,s=new Array(o);s[0]=m;var i={};for(var u in a)hasOwnProperty.call(a,u)&&(i[u]=a[u]);i.originalType=e,i[p]="string"==typeof e?e:r,s[1]=i;for(var l=2;l<o;l++)s[l]=t[l];return n.createElement.apply(null,s)}return n.createElement.apply(null,t)}m.displayName="MDXCreateElement"},6579:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>u,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var n=t(7462),r=(t(7294),t(3905));const o={},s="Testeando la clase User",i={unversionedId:"Version 1.0/SPRINT 4 - BACKEND/ORM para el mapping en javascript/User.test",id:"Version 1.0/SPRINT 4 - BACKEND/ORM para el mapping en javascript/User.test",title:"Testeando la clase User",description:"Ahora ya va en serio, vamos a empezar testeando la clase User.",source:"@site/docs/03-Version 1.0/SPRINT 4 - BACKEND/07-ORM para el mapping en javascript/03-User.test.md",sourceDirName:"03-Version 1.0/SPRINT 4 - BACKEND/07-ORM para el mapping en javascript",slug:"/Version 1.0/SPRINT 4 - BACKEND/ORM para el mapping en javascript/User.test",permalink:"/vanillaPill/docs/Version 1.0/SPRINT 4 - BACKEND/ORM para el mapping en javascript/User.test",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/03-Version 1.0/SPRINT 4 - BACKEND/07-ORM para el mapping en javascript/03-User.test.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Testing de las clases con Mocha y Chai",permalink:"/vanillaPill/docs/Version 1.0/SPRINT 4 - BACKEND/ORM para el mapping en javascript/Testing"},next:{title:"Testeando la clase Perfil",permalink:"/vanillaPill/docs/Version 1.0/SPRINT 4 - BACKEND/ORM para el mapping en javascript/Perfil.test"}},u={},l=[],c={toc:l},p="wrapper";function d(e){let{components:a,...o}=e;return(0,r.kt)(p,(0,n.Z)({},c,o,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"testeando-la-clase-user"},"Testeando la clase User"),(0,r.kt)("p",null,"Ahora ya va en serio, vamos a empezar testeando la clase User."),(0,r.kt)("p",null,"Esto es lo que vamos a hacer:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Creaci\xf3n de Usuario"),": Utilizando el m\xe9todo create() de la clase User, se crea un nuevo usuario con un email y contrase\xf1a. Se verifica que el usuario creado sea una instancia v\xe1lida de User y que su email coincida con el proporcionado.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Inicio de Sesi\xf3n"),": Se intenta iniciar sesi\xf3n con el usuario creado utilizando el m\xe9todo login(). Se verifica que el usuario creado siga siendo una instancia v\xe1lida de User y que el usuario logueado tenga el mismo email que se us\xf3 para crearlo.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Obtenci\xf3n del Usuario Logueado"),": Se verifica que el m\xe9todo getUser() de la clase User devuelva el usuario logueado. Se comprueba que se haya obtenido un usuario, que sea una instancia v\xe1lida de User y que el email del usuario logueado coincida con el que se utiliz\xf3 previamente.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Cierre de Sesi\xf3n"),': Se intenta cerrar la sesi\xf3n del usuario actual con el m\xe9todo logout(). Se verifica que el proceso de cierre de sesi\xf3n se realice con \xe9xito y devuelva true."')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Leer usuario tras cerrar sesi\xf3n"),": Se intenta leer los datos del usuario logueado actual con el m\xe9todo getUser(). Se verifica que el proceso de cierre de sesi\xf3n ha realizado bien por lo que devuelve ",(0,r.kt)("em",{parentName:"p"},"undefined"),"."))),(0,r.kt)("p",null,"Pero antes, debemos eliminar la opci\xf3n de supabase que nos obliga a confirmar la creaci\xf3n de un usuario nuevo mediante la respuesta al email que nos env\xeda el sistema."),(0,r.kt)("p",null,"Para ello nos vamos a supabase, ",(0,r.kt)("strong",{parentName:"p"},"autenticaci\xf3n")," y ",(0,r.kt)("strong",{parentName:"p"},"Providers"),", y modificamos, del proveedor de ",(0,r.kt)("strong",{parentName:"p"},"Email"),", la opci\xf3n '",(0,r.kt)("strong",{parentName:"p"},"Confirm email"),"'"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Alt text",src:t(9922).Z,width:"770",height:"748"})),(0,r.kt)("p",null,"Ahora s\xed, ya podemos escribir el c\xf3digo del test y ejecutarlo:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="user.test.js',title:'"user.test.js'},"import { expect } from 'chai'\n\nimport { User } from '../src/bd/user.js'\n\n// cargamos libreria de supabase\nimport { supabase } from '../src/bd/supabase.js'\n\ndescribe('Pruebas para la Clase User', function () {\n  let usuarioCreado // Variable para almacenar el usuario creado durante las pruebas\n\n  describe('create()', function () {\n    it('deber\xeda crear un nuevo usuario', async function () {\n      const datosUsuario = { email: 'test@example.com', password: 'testPassword' }\n\n      usuarioCreado = await User.create(datosUsuario)\n\n      expect(usuarioCreado).to.be.an.instanceOf(User)\n      expect(usuarioCreado.email).to.equal('test@example.com')\n    })\n  })\n\n  describe('login()', function () {\n    it('deber\xeda iniciar sesi\xf3n de un usuario existente', async function () {\n      expect(usuarioCreado).to.be.an.instanceOf(User)\n\n      const datosLogin = { email: 'test@example.com', password: 'testPassword' }\n\n      const usuarioLogueado = await User.login(datosLogin)\n\n      expect(usuarioLogueado).to.be.an.instanceOf(User)\n      expect(usuarioLogueado.email).to.equal('test@example.com')\n    })\n  })\n\n  describe('getUser()', function () {\n    it('deber\xeda devolver el usuario logueado', async function () {\n      // Supongamos que 'usuarioLogueado' es el usuario que se espera obtener al estar logueado\n      const usuarioLogueado = await User.getUser()\n\n      // Verificamos que se haya obtenido el usuario esperado\n      expect(usuarioLogueado).to.exist // Aseguramos que haya un usuario logueado\n      expect(usuarioLogueado).to.be.an.instanceOf(User) // Verificamos que sea una instancia de User\n\n      // Verificamos la propiedad 'email' del usuario logueado\n      expect(usuarioLogueado.email).to.equal('test@example.com') // Reemplaza 'correo@example.com' con el email esperado del usuario logueado\n    })\n  })\n\n  \n\n  describe('logout()', function () {\n    it('deber\xeda cerrar sesi\xf3n del usuario actual', async function () {\n      const sesionCerrada = await User.logout()\n\n      expect(sesionCerrada).to.equal(true)\n    })\n  })\n\n  describe('getUser()', function () {\n    it('deber\xeda devolver undefined si no hay usuario logueado', async function () {\n      // Supongamos que 'usuarioLogueado' es el usuario que se espera obtener al estar logueado\n      const usuarioLogueado = await User.getUser()\n\n      // Verificamos que el usuario logueado sea undefined, indicando que no hay sesi\xf3n activa\n      expect(usuarioLogueado).to.equal(undefined)\n      // Tambi\xe9n podr\xedamos usar:\n      // expect(usuarioLogueado).to.be.undefined;\n      // o\n      // expect(usuarioLogueado).to.not.exist;\n    })\n  })\n})\n\n")),(0,r.kt)("p",null,"Al ejecutar el test con ",(0,r.kt)("inlineCode",{parentName:"p"},"npm run test")," obtenemos estos resultados:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Alt text",src:t(7863).Z,width:"643",height:"805"}),"\n",(0,r.kt)("img",{alt:"Alt text",src:t(9005).Z,width:"652",height:"226"})),(0,r.kt)("admonition",{title:"Ten en cuenta que",type:"note"},(0,r.kt)("p",{parentName:"admonition"},"En este test ",(0,r.kt)("strong",{parentName:"p"},"no hemos borrado el usuario creado"),", ya que despu\xe9s lo vamos a necesitar para probar el resto de clases."),(0,r.kt)("p",{parentName:"admonition"},"Si el test falla y debes volver a ejecutarlo ",(0,r.kt)("strong",{parentName:"p"},"deber\xe1s borrar a mano este usuario"),".")),(0,r.kt)("p",null,"Ya hemos testeado con absoluto \xe9xito la clase User. Ahora tocar\xeda escribir los test para la clase ",(0,r.kt)("strong",{parentName:"p"},"Perfil")," y la clase ",(0,r.kt)("strong",{parentName:"p"},"Proyecto")))}d.isMDXComponent=!0},7863:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/image-3-18643620baa9a51779a572a4661652fa.png"},9005:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/image-4-5c5c7105fe8beb1f53f2a72527ce7231.png"},9922:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/image-5-87792411b63ce5e56b0211063866f023.png"}}]);