"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3679],{3905:(e,a,t)=>{t.d(a,{Zo:()=>c,kt:()=>b});var s=t(7294);function o(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function r(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);a&&(s=s.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,s)}return t}function n(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?r(Object(t),!0).forEach((function(a){o(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function i(e,a){if(null==e)return{};var t,s,o=function(e,a){if(null==e)return{};var t,s,o={},r=Object.keys(e);for(s=0;s<r.length;s++)t=r[s],a.indexOf(t)>=0||(o[t]=e[t]);return o}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(s=0;s<r.length;s++)t=r[s],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=s.createContext({}),p=function(e){var a=s.useContext(l),t=a;return e&&(t="function"==typeof e?e(a):n(n({},a),e)),t},c=function(e){var a=p(e.components);return s.createElement(l.Provider,{value:a},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var a=e.children;return s.createElement(s.Fragment,{},a)}},m=s.forwardRef((function(e,a){var t=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=p(t),m=o,b=d["".concat(l,".").concat(m)]||d[m]||u[m]||r;return t?s.createElement(b,n(n({ref:a},c),{},{components:t})):s.createElement(b,n({ref:a},c))}));function b(e,a){var t=arguments,o=a&&a.mdxType;if("string"==typeof e||o){var r=t.length,n=new Array(r);n[0]=m;var i={};for(var l in a)hasOwnProperty.call(a,l)&&(i[l]=a[l]);i.originalType=e,i[d]="string"==typeof e?e:o,n[1]=i;for(var p=2;p<r;p++)n[p]=t[p];return s.createElement.apply(null,n)}return s.createElement.apply(null,t)}m.displayName="MDXCreateElement"},327:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>l,contentTitle:()=>n,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>p});var s=t(7462),o=(t(7294),t(3905));const r={Title:"Construyendo tablas y usuarios"},n=void 0,i={unversionedId:"Version 1.0/SPRINT 4 - BACKEND/Construcci\xf3n de tablas y usuarios",id:"Version 1.0/SPRINT 4 - BACKEND/Construcci\xf3n de tablas y usuarios",title:"Construcci\xf3n de tablas y usuarios",description:"En la barra de herramientas tenemos la opci\xf3n Tabla Editor. Este editor nos va a facilitar mucho la creaci\xf3n de las tablas de nuestro proyecto.",source:"@site/docs/03-Version 1.0/SPRINT 4 - BACKEND/05-Construcci\xf3n de tablas y usuarios.md",sourceDirName:"03-Version 1.0/SPRINT 4 - BACKEND",slug:"/Version 1.0/SPRINT 4 - BACKEND/Construcci\xf3n de tablas y usuarios",permalink:"/vanillaPill/docs/Version 1.0/SPRINT 4 - BACKEND/Construcci\xf3n de tablas y usuarios",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/03-Version 1.0/SPRINT 4 - BACKEND/05-Construcci\xf3n de tablas y usuarios.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{Title:"Construyendo tablas y usuarios"},sidebar:"tutorialSidebar",previous:{title:"Supabase como servicio backend",permalink:"/vanillaPill/docs/Version 1.0/SPRINT 4 - BACKEND/Supabase como servicio backend"},next:{title:"Historia 1: Supabase. Introducci\xf3n al BackEnd como servicio.",permalink:"/vanillaPill/docs/Version 1.0/SPRINT 4 - BACKEND/Probando Supabase con Javascript/h1"}},l={},p=[{value:"Creamos Tabla Perfiles",id:"creamos-tabla-perfiles",level:2},{value:"Creamos Tabla proyectos",id:"creamos-tabla-proyectos",level:2},{value:"Registramos Usuarios",id:"registramos-usuarios",level:2},{value:"A\xf1adimos datos a la tabla perfiles",id:"a\xf1adimos-datos-a-la-tabla-perfiles",level:2},{value:"Primera consulta a la tabla perfiles",id:"primera-consulta-a-la-tabla-perfiles",level:2},{value:"Insertando datos en la tabla proyectos",id:"insertando-datos-en-la-tabla-proyectos",level:2}],c={toc:p},d="wrapper";function u(e){let{components:a,...r}=e;return(0,o.kt)(d,(0,s.Z)({},c,r,{components:a,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"En la barra de herramientas tenemos la opci\xf3n ",(0,o.kt)("inlineCode",{parentName:"p"},"Tabla Editor"),". Este editor nos va a facilitar mucho la creaci\xf3n de las tablas de nuestro proyecto. "),(0,o.kt)("p",null,"Hagamos memoria. Seg\xfan nuestro diagrama ER, necesitamos tres tablas: ",(0,o.kt)("strong",{parentName:"p"},"users"),", ",(0,o.kt)("em",{parentName:"p"},"perfiles")," y ",(0,o.kt)("strong",{parentName:"p"},"proyectos"),". Tanto las tablas perfiles como la tabla proyectos son tablas ",(0,o.kt)("inlineCode",{parentName:"p"},"public")," (p\xfablicas) y debemos crear nosotros. La tabla 'users' es una tabla que se crea de manera autom\xe1tica en Supabase cuando registras usuarios y pertenece al dominio ",(0,o.kt)("inlineCode",{parentName:"p"},"auth"),"."),(0,o.kt)("h2",{id:"creamos-tabla-perfiles"},"Creamos Tabla Perfiles"),(0,o.kt)("p",null,"Vamos a crear la tabla perfiles mediante la interfaz de Supabase."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Create tabla",src:t(9926).Z,width:"661",height:"482"})),(0,o.kt)("p",null,"Aseg\xfarate de ",(0,o.kt)("strong",{parentName:"p"},"eliminar las politicas de acceso a la tabla"),". M\xe1s adelante las definiremos para determinar qui\xe9n puede hacer qu\xe9 dependiendo del rol asociado al usuario que accede."),(0,o.kt)("admonition",{title:"\xbfQu\xe9 son las politicas de acceso de supabase?",type:"info"},(0,o.kt)("p",{parentName:"admonition"}," Las pol\xedticas de acceso en Supabase son conjuntos de reglas que estableces para controlar qui\xe9nes pueden acceder a qu\xe9 datos y realizar qu\xe9 acciones dentro de tu aplicaci\xf3n o base de datos. "),(0,o.kt)("p",{parentName:"admonition"}," Esto te permite gestionar qui\xe9n puede ",(0,o.kt)("strong",{parentName:"p"},"ver"),", ",(0,o.kt)("em",{parentName:"p"},"modificar")," o ",(0,o.kt)("em",{parentName:"p"},"eliminar")," informaci\xf3n espec\xedfica, y tambi\xe9n definir ",(0,o.kt)("strong",{parentName:"p"},"permisos especiales")," para ciertos usuarios si es necesario.")),(0,o.kt)("p",null,"Al crearse la tabla se crean autom\xe1ticamente los campos ",(0,o.kt)("strong",{parentName:"p"},"id")," (que ser\xe1 un numero entero autoincremental y se convertir\xe1 en la ",(0,o.kt)("strong",{parentName:"p"},"clave \xfanica"),") y ",(0,o.kt)("strong",{parentName:"p"},"create_at")," que guardar\xe1 la fecha y hora de creaci\xf3n del registro (con tipo timestamptz)."),(0,o.kt)("p",null,"A continuaci\xf3n crearemos el resto de campos indicando el ",(0,o.kt)("strong",{parentName:"p"},"type")," para cada campo."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"campos de tabla perfiles",src:t(7788).Z,width:"754",height:"601"})),(0,o.kt)("p",null,"Y finalmente vamos a vincular el campo ",(0,o.kt)("strong",{parentName:"p"},"user_id")," con el campo ",(0,o.kt)("strong",{parentName:"p"},"id")," de la tabla ",(0,o.kt)("inlineCode",{parentName:"p"},"auth.users")," creando una clave foranea. Asegurate de marcar la opci\xf3n ",(0,o.kt)("strong",{parentName:"p"},"Cascade")," de 'Action if referenced row is removed'. De esta manera, si borrarmos un registro de la tabla ",(0,o.kt)("inlineCode",{parentName:"p"},"auth.users")," se borrar\xe1 tambi\xe9n el registro de la tabla '",(0,o.kt)("inlineCode",{parentName:"p"},"perfiles"),"' asociado a ese usuario."),(0,o.kt)("h2",{id:"creamos-tabla-proyectos"},"Creamos Tabla proyectos"),(0,o.kt)("p",null,"Para la tabla proyectos emplearemos el mismo procedimiento"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"campos de tabla perfiles",src:t(4964).Z,width:"690",height:"660"})),(0,o.kt)("p",null,"No olvides crear la clave foranea de los campos ",(0,o.kt)("strong",{parentName:"p"},"user_id")," e ",(0,o.kt)("strong",{parentName:"p"},"id")," de las tablas ",(0,o.kt)("strong",{parentName:"p"},"public.proyectos")," y ",(0,o.kt)("strong",{parentName:"p"},"auth.users")," "),(0,o.kt)("p",null,"Ahora que tenemos las tres tablas creadas podemos visualizarlas con el nuevo ",(0,o.kt)("strong",{parentName:"p"},"Schema Visualizer")," que incorpora Supabase"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"campos de tabla perfiles",src:t(5904).Z,width:"820",height:"780"})),(0,o.kt)("p",null,"En esta imagen puedes ver las tablas p\xfablicas. Si quieres ver los campos que incorpora la tabla auth.users puedes modificar el filtro superior por 'auth'"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Visualizador de esquema de tablas",src:t(6697).Z,width:"1057",height:"861"})),(0,o.kt)("h2",{id:"registramos-usuarios"},"Registramos Usuarios"),(0,o.kt)("p",null,"Vamos a a\xf1adir algunos usuarios a nuestra tabla users. Comenzamos por los usuarios. "),(0,o.kt)("p",null,"Hay muchas maneras de registrar usuarios, pero ahora la m\xe1s f\xe1cil para nosotros es usando la opci\xf3n ",(0,o.kt)("inlineCode",{parentName:"p"},"Add user"),"del men\xfa ",(0,o.kt)("inlineCode",{parentName:"p"},"Authentication")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Nuevo usuario",src:t(2341).Z,width:"456",height:"434"}),"."),(0,o.kt)("p",null,"Podemos crear algunos usuarios m\xe1s para poder hacer pruebas. Estos son los que he creado yo. Tu puedes hacer lo mismo:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Nuevos usuarios",src:t(111).Z,width:"1319",height:"485"}),"."),(0,o.kt)("h2",{id:"a\xf1adimos-datos-a-la-tabla-perfiles"},"A\xf1adimos datos a la tabla perfiles"),(0,o.kt)("p",null,"Como ya tenemos los usuarios registrados (como se muestra en la tabla auth.users) podemos crear los registros de la tabla ",(0,o.kt)("inlineCode",{parentName:"p"},"perfiles")," asociados a cada uno de estos usuarios."),(0,o.kt)("p",null,"Podemos hacerlo con ",(0,o.kt)("strong",{parentName:"p"},"consultas sql")," o directamente accediendo a las tablas desde la opci\xf3n ",(0,o.kt)("inlineCode",{parentName:"p"},"Table editor")," y a\xf1adiendo registros. Vamos a hacerlo con este \xfaltimo m\xe9todo."),(0,o.kt)("p",null,"Desde el editor de tablas, haz clic sobre el nombre de la tabla ",(0,o.kt)("inlineCode",{parentName:"p"},"perfiles")," y utiliza el bot\xf3n ",(0,o.kt)("inlineCode",{parentName:"p"},"Insert")," para a\xf1adir registros (filas), tal y como se muestra en la figura:"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Nuevos usuarios",src:t(4726).Z,width:"503",height:"680"}),"."),(0,o.kt)("p",null,"En el campo avatar (que es de tipo texto), por el momento he a\xf1adido la url de una imagen externa. (He usado la cara de algunos m\xfasicos... que me perdonen por lo que respecta a los derechos de autor \ud83d\ude05)"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Nuevos usuarios",src:t(3553).Z,width:"832",height:"182"}),"."),(0,o.kt)("admonition",{title:"F\xedjate bien",type:"note"},(0,o.kt)("p",{parentName:"admonition"},"Al completar los datos de cada perfil, en el campo ",(0,o.kt)("strong",{parentName:"p"},"user_id")," he utilizado el ",(0,o.kt)("strong",{parentName:"p"},"id")," de la tabla ",(0,o.kt)("inlineCode",{parentName:"p"},"auth.users"))),(0,o.kt)("h2",{id:"primera-consulta-a-la-tabla-perfiles"},"Primera consulta a la tabla perfiles"),(0,o.kt)("p",null,"Ahora que tenemos la tabla perfiles con datos, vamos a hacer una consulta sql desde el SQL Editor:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"select * from perfiles\n")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Nuevos usuarios",src:t(5753).Z,width:"833",height:"288"}),"."),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Una opci\xf3n interesante es que podemos guardar las consultas que hacemos.")),(0,o.kt)("h2",{id:"insertando-datos-en-la-tabla-proyectos"},"Insertando datos en la tabla proyectos"),(0,o.kt)("p",null,"Para insertar datos en la tabla proyectos vamos a utilizar el editor de consultas. Nos ayudaremos de la IA para facilitarnos el trabajo:"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"Pregunta a ChatGPT"))),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Nuevos usuarios",src:t(499).Z,width:"696",height:"452"}),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("em",{parentName:"strong"},"Respuesta de ChatGPT"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sql",metastring:'title="Consulta SQL"',title:'"Consulta','SQL"':!0},"INSERT INTO proyectos (user_id, nombre, descripcion, imagen, enlace, repositorio, estado)\nVALUES \n  ('2ab09b38-6629-414d-bcf5-ebb26e638973', 'Proyecto de Gesti\xf3n de Inventario', 'Este proyecto permite gestionar el inventario de una empresa', 'https://imagen.com/gestion-inventario.jpg', 'https://enlace.com/gestion-inventario', 'https://github.com/proyecto-gestion-inventario', 'Activo'),\n  ('2ab09b38-6629-414d-bcf5-ebb26e638973', 'Proyecto de Gesti\xf3n de Personal', 'Este proyecto permite gestionar el personal de una empresa', 'https://imagen.com/gestion-personal.jpg', 'https://enlace.com/gestion-personal', 'https://github.com/proyecto-gestion-personal', 'Inactivo'),\n  ('2ab09b38-6629-414d-bcf5-ebb26e638973', 'Proyecto de An\xe1lisis de Datos de Ventas', 'Este proyecto permite analizar los datos de ventas de una empresa', 'https://imagen.com/analisis-ventas.jpg', 'https://enlace.com/analisis-ventas', 'https://github.com/proyecto-analisis-ventas', 'Activo'),\n  ('1dd53fb9-fa27-4aa3-8c91-2b5de5edba76', 'Proyecto de An\xe1lisis de Redes Sociales', 'Este proyecto permite analizar las redes sociales de una empresa', 'https://imagen.com/analisis-redes-sociales.jpg', 'https://enlace.com/analisis-redes-sociales', 'https://github.com/proyecto-analisis-redes-sociales', 'Activo'),\n  ('1dd53fb9-fa27-4aa3-8c91-2b5de5edba76', 'Proyecto de Gesti\xf3n de Proyectos', 'Este proyecto permite gestionar proyectos de una empresa', 'https://imagen.com/gestion-proyectos.jpg', 'https://enlace.com/gestion-proyectos', 'https://github.com/proyecto-gestion-proyectos', 'Inactivo'),\n  ('1dd53fb9-fa27-4aa3-8c91-2b5de5edba76', 'Proyecto de Visualizaci\xf3n de Datos', 'Este proyecto permite visualizar datos de una empresa', 'https://imagen.com/visualizacion-datos.jpg', 'https://enlace.com/visualizacion-datos', 'https://github.com/proyecto-visualizacion-datos', 'Activo'),\n  ('1dd53fb9-fa27-4aa3-8c91-2b5de5edba76', 'Proyecto de An\xe1lisis de Datos de Marketing', 'Este proyecto permite analizar los datos de marketing de una empresa', 'https://imagen.com/analisis-marketing.jpg', 'https://enlace.com/analisis-marketing', 'https://github.com/proyecto-analisis-marketing', 'Inactivo');\n  \n")),(0,o.kt)("admonition",{title:"Ten en cuenta que..",type:"warning"},(0,o.kt)("p",{parentName:"admonition"},"  Si copias el c\xf3digo, no olvides modificar los ",(0,o.kt)("strong",{parentName:"p"},"user_id")," para que correspondan con los datos de tu bd.")),(0,o.kt)("p",null,"Y si ahora hacemos una consulta a la tabla proyectos deber\xedamos ver los datos introducidos:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sql"},"select * from proyectos\n")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Nuevos usuarios",src:t(8175).Z,width:"831",height:"389"}),"."),(0,o.kt)("p",null,"\xa1Genial! Todo seg\xfan los previsto \ud83d\ude0e"))}u.isMDXComponent=!0},499:(e,a,t)=>{t.d(a,{Z:()=>s});const s=t.p+"assets/images/chatgpt-564c889568763d7becfb2714131e99a2.png"},5753:(e,a,t)=>{t.d(a,{Z:()=>s});const s=t.p+"assets/images/consultaPerfiles-9f17aa9b4d3bfefa034ded2dc543a7ad.png"},9926:(e,a,t)=>{t.d(a,{Z:()=>s});const s=t.p+"assets/images/creartabla-436a84206bb54b5e76a9685581b4518b.png"},3553:(e,a,t)=>{t.d(a,{Z:()=>s});const s=t.p+"assets/images/datosPerfiles-2f4ee92abd7e49681176c33215a0b64d.png"},8175:(e,a,t)=>{t.d(a,{Z:()=>s});const s=t.p+"assets/images/datosProyectos-4775eac8e58dbbb703792817a951ba76.png"},2341:(e,a,t)=>{t.d(a,{Z:()=>s});const s=t.p+"assets/images/newuser-dedf654dda31e4f9b094b0d6081d95f8.png"},4726:(e,a,t)=>{t.d(a,{Z:()=>s});const s=t.p+"assets/images/nuevoPerfil-505cb089c70f64e81e803851a549b907.png"},7788:(e,a,t)=>{t.d(a,{Z:()=>s});const s=t.p+"assets/images/perfiles-9cd9b357e8b44109a9d085a3413c17b1.png"},5904:(e,a,t)=>{t.d(a,{Z:()=>s});const s=t.p+"assets/images/schemavisualizer-873bfd294fd4e9898c620513bd492739.png"},6697:(e,a,t)=>{t.d(a,{Z:()=>s});const s=t.p+"assets/images/schemavisualizer_users-7b933bde53487e4245c713b5e4056520.png"},4964:(e,a,t)=>{t.d(a,{Z:()=>s});const s=t.p+"assets/images/tablaproyectos-43277143929fb8744bbe73cb2abd1ed7.png"},111:(e,a,t)=>{t.d(a,{Z:()=>s});const s=t.p+"assets/images/users-f7a90302ef8ac813acb77ac8389736c3.png"}}]);